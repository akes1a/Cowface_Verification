# 牛脸识别系统

本项目旨在通过深度学习技术实现牛脸识别，主要包括以下模块：
- **数据加载与预处理**：从图像中提取特征。
- **特征提取**：使用预训练的 ResNet 模型提取图像特征。
- **相似度计算**：基于特征向量计算图像对的相似度。
- **分类器**：使用逻辑回归模型对相似度进行分类。
- **可视化**：通过混淆矩阵、ROC 曲线等评估模型性能。

## 使用说明

## 环境配置
pip install -r requirements.txt

## 日志记录
在utils目录下的logger.py中配置日志记录文件路径，默认为None，日志文件将保存在logs目录下。

## 直接使用以下命令运行项目中的脚本：

### 进入项目根目录
cd ...\cowface

### 查看 PyTorch 检测 GPU available
python -c "import torch; print('cuda available=', torch.cuda.is_available()); print('device count=', torch.cuda.device_count())"

### 运行训练脚本（输出使用的设备）
python -u scripts/train.py

### 测试模型：
python -u scripts/test.py

## 使用main.py脚本进行训练和测试的示例命令如下：

### 训练模型
要使用 `main.py` 进行模型训练，请运行以下命令：

```bash
python main.py train --config configs/config.yaml
```

- `--config`：指定配置文件路径（可选，默认为 `configs/config.yaml`）。

此命令将加载配置文件中的参数，初始化数据加载、特征提取和模型训练流程，并将训练好的模型保存到 `saved_models` 目录下。


### 测试模型
要使用 `main.py` 进行模型测试，请运行以下命令：

```bash
python main.py test --model saved_models/cowface_model.pkl
```

- `--model`：指定训练好的模型文件路径（必需）。

此命令将加载指定的模型文件，并对测试数据进行预测，生成测试结果。

### 查看帮助
要查看 `main.py` 的帮助信息，请运行以下命令：

```bash
python main.py --help
```

此命令将显示所有可用的子命令及其参数说明。

